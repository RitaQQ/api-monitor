<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API ç›£æ§å„€è¡¨æ¿</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .stat-label {
            color: #666;
            font-size: 0.9em;
        }
        .healthy { color: #28a745; }
        .unhealthy { color: #dc3545; }
        .unknown { color: #6c757d; }
        
        .api-list {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .api-item {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: grid;
            grid-template-columns: 1fr auto auto auto auto auto;
            gap: 20px;
            align-items: center;
        }
        .api-item:last-child {
            border-bottom: none;
        }
        .api-info h3 {
            margin: 0 0 5px 0;
            color: #333;
        }
        .api-info p {
            margin: 0;
            color: #666;
            font-size: 0.9em;
        }
        .status-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
            text-transform: uppercase;
        }
        .status-healthy {
            background: #d4edda;
            color: #155724;
        }
        .status-unhealthy {
            background: #f8d7da;
            color: #721c24;
        }
        .status-unknown {
            background: #e2e3e5;
            color: #383d41;
        }
        .response-time {
            font-family: 'Courier New', monospace;
            font-weight: bold;
        }
        .last-check {
            font-size: 0.85em;
            color: #666;
        }
        .controls {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            justify-content: space-between;
            align-items: center;
        }
        .privacy-toggle {
            background-color: #6c757d;
            color: white;
            font-size: 0.85em;
            padding: 8px 16px;
        }
        .privacy-toggle.active {
            background-color: #28a745;
        }
        .url-hidden {
            color: #6c757d;
            font-style: italic;
        }
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            text-decoration: none;
            display: inline-block;
        }
        .btn-primary {
            background-color: #007bff;
            color: white;
        }
        .btn-success {
            background-color: #28a745;
            color: white;
        }
        .btn:hover {
            opacity: 0.9;
        }
        .error-count {
            background: #dc3545;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
        }
        .auto-refresh {
            font-size: 0.9em;
            color: #666;
        }
        .btn-stress {
            background-color: #6f42c1;
            color: white;
            font-size: 0.8em;
            padding: 6px 12px;
        }
        .stress-running {
            background-color: #fd7e14;
            color: white;
            font-size: 0.8em;
            padding: 6px 12px;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.6; }
            100% { opacity: 1; }
        }
        .btn-results {
            background-color: #17a2b8;
            color: white;
            font-size: 0.8em;
            padding: 6px 12px;
        }
        
        /* é€²è¡Œä¸­æŒ‰éˆ•æ¨£å¼ */
        .btn-processing {
            background: linear-gradient(45deg, #fd7e14, #ff6b35);
            color: white;
            position: relative;
            overflow: hidden;
            pointer-events: none;
            opacity: 0.8;
        }
        
        .btn-checking {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            position: relative;
            overflow: hidden;
            pointer-events: none;
            opacity: 0.8;
        }
        
        /* Loading spinner */
        .spinner {
            display: inline-block;
            width: 12px;
            height: 12px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 2px solid #fff;
            animation: spin 1s linear infinite;
            margin-right: 5px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* æ³¢ç´‹æ•ˆæœ */
        .ripple-effect {
            position: relative;
            overflow: hidden;
        }
        
        .ripple-effect::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .ripple-effect.active::before {
            width: 300px;
            height: 300px;
        }
        
        /* é€²åº¦æŒ‡ç¤ºå™¨ */
        .progress-indicator {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 15px;
            margin-top: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #fd7e14;
            animation: slideDown 0.3s ease;
        }
        
        .progress-indicator.show {
            display: block;
        }
        
        .progress-text {
            font-size: 0.9em;
            color: #333;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .progress-bar-container {
            width: 100%;
            height: 4px;
            background: #e9ecef;
            border-radius: 2px;
            overflow: hidden;
        }
        
        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #fd7e14, #ff6b35);
            border-radius: 2px;
            animation: progressFlow 2s ease-in-out infinite;
        }
        
        @keyframes progressFlow {
            0% { width: 0%; }
            50% { width: 70%; }
            100% { width: 100%; }
        }
        
        @keyframes slideDown {
            from { 
                opacity: 0;
                transform: translateY(-10px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* æª¢æŸ¥ä¸­çš„ç‰¹æ®Šæ•ˆæœ */
        .checking-glow {
            animation: checkingGlow 2s ease-in-out infinite;
        }
        
        @keyframes checkingGlow {
            0%, 100% { 
                box-shadow: 0 0 5px rgba(40, 167, 69, 0.5);
            }
            50% { 
                box-shadow: 0 0 20px rgba(40, 167, 69, 0.8);
            }
        }
        
        /* è‡ªå®šç¾©æ¨¡æ…‹å°è©±æ¡†æ¨£å¼ */
        .custom-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }
        
        .modal-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 10% auto;
            padding: 0;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            transform: scale(0.7);
            animation: modalSlideIn 0.3s ease forwards;
            color: white;
        }
        
        .modal-header {
            padding: 25px 30px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
        }
        
        .modal-title {
            font-size: 1.8em;
            margin: 0;
            font-weight: bold;
        }
        
        .modal-icon {
            font-size: 3em;
            margin-bottom: 15px;
            animation: pulse 2s ease-in-out infinite;
        }
        
        .modal-body {
            padding: 25px 30px;
            line-height: 1.6;
        }
        
        .modal-subtitle {
            font-size: 1.2em;
            margin-bottom: 20px;
            opacity: 0.9;
        }
        
        .stress-params {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
        }
        
        .param-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 1.1em;
        }
        
        .param-label {
            opacity: 0.8;
        }
        
        .param-value {
            font-weight: bold;
            color: #ffd700;
        }
        
        .modal-footer {
            padding: 20px 30px 30px;
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        
        .modal-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .modal-btn-confirm {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4);
        }
        
        .modal-btn-confirm:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.6);
        }
        
        .modal-btn-cancel {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .modal-btn-cancel:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes modalSlideIn {
            from { 
                transform: scale(0.7) translateY(-50px);
                opacity: 0;
            }
            to { 
                transform: scale(1) translateY(0);
                opacity: 1;
            }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 768px) {
            .modal-content {
                width: 95%;
                margin: 20% auto;
            }
            
            .modal-header, .modal-body, .modal-footer {
                padding: 20px;
            }
            
            .modal-title {
                font-size: 1.5em;
            }
            
            .modal-icon {
                font-size: 2.5em;
            }
        }
    </style>
    <script>
        // æ¯ 30 ç§’è‡ªå‹•é‡æ–°æ•´ç†é é¢
        setTimeout(function() {
            window.location.reload();
        }, 30000);
        
        // é¡¯ç¤ºå€’æ•¸è¨ˆæ™‚
        let countdown = 30;
        setInterval(function() {
            countdown--;
            const element = document.getElementById('countdown');
            if (element) {
                element.textContent = countdown;
            }
            if (countdown <= 0) {
                countdown = 30;
            }
        }, 1000);
    </script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” API ç›£æ§å„€è¡¨æ¿</h1>
            <p>å³æ™‚ç›£æ§ç³»çµ± API å¥åº·ç‹€æ…‹</p>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-number healthy">{{ stats.healthy }}</div>
                <div class="stat-label">æ­£å¸¸é‹è¡Œ</div>
            </div>
            <div class="stat-card">
                <div class="stat-number unhealthy">{{ stats.unhealthy }}</div>
                <div class="stat-label">ç•°å¸¸ç‹€æ…‹</div>
            </div>
            <div class="stat-card">
                <div class="stat-number unknown">{{ stats.unknown }}</div>
                <div class="stat-label">æœªçŸ¥ç‹€æ…‹</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">{{ stats.total }}</div>
                <div class="stat-label">ç¸½è¨ˆ API</div>
            </div>
        </div>
        
        <div class="controls">
            <div>
                <a href="/admin" class="btn btn-primary">âš™ï¸ ç®¡ç† API</a>
                <a href="/check-now" class="btn btn-success">ğŸ”„ ç«‹å³æª¢æŸ¥</a>
                <button id="privacy-toggle" class="btn privacy-toggle" onclick="togglePrivacy()">
                    ğŸ™ˆ éš±è— URL
                </button>
            </div>
            <div class="auto-refresh">
                é é¢å°‡åœ¨ <span id="countdown">30</span> ç§’å¾Œè‡ªå‹•é‡æ–°æ•´ç†
            </div>
        </div>
        
        <div class="api-list">
            {% for api in apis %}
            <div class="api-item api-card" data-api-id="{{ api.id }}">
                <div class="api-info">
                    <h3>{{ api.name }}</h3>
                    <p class="api-url" data-url="{{ api.url }}">{{ api.url }}</p>
                    <p><strong>æ–¹æ³•:</strong> {{ api.method or 'GET' }} | <strong>é¡å‹:</strong> {{ api.type }}</p>
                    {% if api.last_response %}
                    <details style="margin-top: 10px;">
                        <summary style="cursor: pointer; color: #007bff; font-weight: bold; font-size: 0.9em;">ğŸ“„ æŸ¥çœ‹å›æ‡‰</summary>
                        <pre style="background: #f8f9fa; padding: 10px; border-radius: 5px; font-size: 0.8em; margin-top: 5px; overflow-x: auto; white-space: pre-wrap; max-height: 200px; border: 1px solid #dee2e6;">{{ api.last_response }}</pre>
                    </details>
                    {% endif %}
                </div>
                <div class="status-badge status-{{ api.status }}">
                    {{ 'âœ… æ­£å¸¸' if api.status == 'healthy' else ('âŒ ç•°å¸¸' if api.status == 'unhealthy' else 'â“ æœªçŸ¥') }}
                </div>
                <div class="response-time">
                    {% if api.response_time and api.response_time > 0 %}
                        {{ "%.3f"|format(api.response_time) }}s
                    {% else %}
                        -
                    {% endif %}
                </div>
                <div class="last-check">
                    {% if api.last_check %}
                        {{ api.last_check[:19].replace('T', ' ') }}
                    {% else %}
                        å°šæœªæª¢æŸ¥
                    {% endif %}
                </div>
                <div>
                    {% if api.error_count > 0 %}
                        <span class="error-count">éŒ¯èª¤ {{ api.error_count }} æ¬¡</span>
                    {% endif %}
                </div>
                <div style="display: flex; gap: 5px; flex-direction: column;">
                    <a href="javascript:void(0)" class="btn btn-stress" 
                       onclick="showStressTestModal('{{ api.id }}', '{{ api.name }}', {{ api.stress_test.concurrent_requests if api.stress_test else 1 }}, {{ api.stress_test.duration_seconds if api.stress_test else 10 }}, {{ api.stress_test.interval_seconds if api.stress_test else 1.0 }})">
                        ğŸ”¥ å£“åŠ›æ¸¬è©¦
                    </a>
                    {% if api.stress_test and api.stress_test.results %}
                    <a href="/stress-test-results/{{ api.id }}" class="btn btn-results">
                        ğŸ“Š æŸ¥çœ‹çµæœ ({{ api.stress_test.results|length }})
                    </a>
                    {% set latest_test = api.stress_test.results[-1] %}
                    <div style="background: #f8f9fa; padding: 8px; border-radius: 4px; font-size: 0.75em; margin-top: 5px;">
                        <div style="font-weight: bold; color: #6f42c1;">æœ€æ–°æ¸¬è©¦:</div>
                        <div>ç¸½è«‹æ±‚: {{ latest_test.statistics.total_requests }} å€‹</div>
                        <div>æˆåŠŸç‡: {{ "%.1f"|format(latest_test.statistics.success_rate) }}%</div>
                        <div>å¹³å‡å›æ‡‰: {{ "%.3f"|format(latest_test.statistics.avg_response_time) }}s</div>
                        <div style="color: #666;">{{ latest_test.start_time[:16].replace('T', ' ') }}</div>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% else %}
            <div class="api-item">
                <div style="text-align: center; color: #666; grid-column: 1 / -1;">
                    <p>ğŸ” å°šæœªæ·»åŠ ä»»ä½• API</p>
                    <p><a href="/admin" class="btn btn-primary">é–‹å§‹æ·»åŠ  API</a></p>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <script>
        // éš±ç§åˆ‡æ›åŠŸèƒ½
        let privacyMode = localStorage.getItem('privacy-mode') === 'true';
        
        function togglePrivacy() {
            privacyMode = !privacyMode;
            localStorage.setItem('privacy-mode', privacyMode);
            updatePrivacyDisplay();
        }
        
        function updatePrivacyDisplay() {
            const button = document.getElementById('privacy-toggle');
            const apiUrls = document.querySelectorAll('.api-url');
            
            if (privacyMode) {
                button.textContent = 'ğŸ‘ï¸ é¡¯ç¤º URL';
                button.classList.add('active');
                apiUrls.forEach(element => {
                    element.textContent = '*** API URL å·²éš±è— (Demo æ¨¡å¼) ***';
                    element.classList.add('url-hidden');
                });
            } else {
                button.textContent = 'ğŸ™ˆ éš±è— URL';
                button.classList.remove('active');
                apiUrls.forEach(element => {
                    element.textContent = element.getAttribute('data-url');
                    element.classList.remove('url-hidden');
                });
            }
        }
        
        // æ¨¡æ…‹å°è©±æ¡†åŠŸèƒ½
        let currentStressTestUrl = '';
        
        function showStressTestModal(apiId, apiName, concurrent, duration, interval) {
            currentStressTestUrl = '/stress-test/' + apiId;
            
            // æ›´æ–°æ¨¡æ…‹æ¡†å…§å®¹
            document.getElementById('modal-api-name').textContent = apiName;
            document.getElementById('param-concurrent').textContent = concurrent + ' å€‹';
            document.getElementById('param-duration').textContent = duration + ' ç§’';
            document.getElementById('param-interval').textContent = interval + ' ç§’';
            
            // é¡¯ç¤ºæ¨¡æ…‹æ¡†
            document.getElementById('stress-test-modal').style.display = 'block';
            document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»¾å‹•
        }
        
        function hideStressTestModal() {
            document.getElementById('stress-test-modal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        function confirmStressTest() {
            // æ‰¾åˆ°å°æ‡‰çš„æŒ‰éˆ•ä¸¦æ›´æ–°ç‹€æ…‹
            const apiId = currentStressTestUrl.split('/').pop();
            const button = document.querySelector(`a[onclick*="${apiId}"]`);
            const apiCard = button ? button.closest('.api-card') : null;
            
            if (button && apiCard) {
                // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
                button.innerHTML = '<span class="spinner"></span>ğŸ”¥ å•Ÿå‹•ä¸­...';
                button.classList.add('btn-processing', 'ripple-effect');
                button.classList.add('active');
                
                // é¡¯ç¤ºé€²åº¦æŒ‡ç¤ºå™¨
                const progressIndicator = createProgressIndicator('æ­£åœ¨å•Ÿå‹•å£“åŠ›æ¸¬è©¦...', 'stress');
                apiCard.appendChild(progressIndicator);
                progressIndicator.classList.add('show');
            }
            
            hideStressTestModal();
            window.location.href = currentStressTestUrl;
        }
        
        // å‰µå»ºé€²åº¦æŒ‡ç¤ºå™¨
        function createProgressIndicator(text, type) {
            const indicator = document.createElement('div');
            indicator.className = 'progress-indicator';
            indicator.innerHTML = `
                <div class="progress-text">${text}</div>
                <div class="progress-bar-container">
                    <div class="progress-bar-fill"></div>
                </div>
            `;
            return indicator;
        }
        
        // ç«‹å³æª¢æŸ¥åŠŸèƒ½å¢å¼·
        function enhanceCheckButton() {
            const checkButton = document.querySelector('a[href="/check-now"]');
            if (checkButton) {
                checkButton.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
                    this.innerHTML = '<span class="spinner"></span>ğŸ”„ æª¢æŸ¥ä¸­...';
                    this.classList.add('btn-checking', 'checking-glow');
                    
                    // é¡¯ç¤ºå…¨å±€é€²åº¦æç¤º
                    showGlobalProgress('æ­£åœ¨æª¢æŸ¥æ‰€æœ‰ API ç‹€æ…‹...');
                    
                    // ç¦ç”¨å…¶ä»–æŒ‰éˆ•
                    disableAllButtons();
                    
                    // åŸ·è¡Œæª¢æŸ¥
                    window.location.href = '/check-now';
                });
            }
        }
        
        // é¡¯ç¤ºå…¨å±€é€²åº¦
        function showGlobalProgress(message) {
            const existingProgress = document.querySelector('.global-progress');
            if (existingProgress) {
                existingProgress.remove();
            }
            
            const progressDiv = document.createElement('div');
            progressDiv.className = 'global-progress';
            progressDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(45deg, #28a745, #20c997);
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
                z-index: 1000;
                animation: slideInRight 0.3s ease;
                font-weight: 500;
            `;
            progressDiv.innerHTML = `
                <span class="spinner" style="margin-right: 10px;"></span>
                ${message}
            `;
            
            document.body.appendChild(progressDiv);
            
            // æ·»åŠ å‹•ç•«æ¨£å¼
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideInRight {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes slideOutRight {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100%); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
        }
        
        // ç¦ç”¨æ‰€æœ‰æ“ä½œæŒ‰éˆ•
        function disableAllButtons() {
            const buttons = document.querySelectorAll('.btn-stress, .btn-results');
            buttons.forEach(btn => {
                btn.style.pointerEvents = 'none';
                btn.style.opacity = '0.5';
            });
        }
        
        // æ¢å¾©æ‰€æœ‰æŒ‰éˆ•
        function enableAllButtons() {
            const buttons = document.querySelectorAll('.btn-stress, .btn-results');
            buttons.forEach(btn => {
                btn.style.pointerEvents = 'auto';
                btn.style.opacity = '1';
            });
        }
        
        // é»æ“Šæ¨¡æ…‹æ¡†å¤–éƒ¨é—œé–‰
        window.onclick = function(event) {
            const modal = document.getElementById('stress-test-modal');
            if (event.target === modal) {
                hideStressTestModal();
            }
        }
        
        // ESC éµé—œé–‰æ¨¡æ…‹æ¡†
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                hideStressTestModal();
            }
        });
        
        // é é¢è¼‰å…¥æ™‚è¨­ç½®åˆå§‹ç‹€æ…‹
        document.addEventListener('DOMContentLoaded', function() {
            updatePrivacyDisplay();
            enhanceCheckButton();
            
            // å¦‚æœé é¢åŒ…å«æ­£åœ¨é€²è¡Œçš„æ“ä½œï¼Œé¡¯ç¤ºå°æ‡‰ç‹€æ…‹
            checkOngoingOperations();
        });
        
        // æª¢æŸ¥æ˜¯å¦æœ‰æ­£åœ¨é€²è¡Œçš„æ“ä½œ
        function checkOngoingOperations() {
            // æª¢æŸ¥URLåƒæ•¸ä¾†åˆ¤æ–·æ˜¯å¦å‰›å¾loadingé é¢è¿”å›
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.has('from_loading')) {
                // ç§»é™¤URLåƒæ•¸
                window.history.replaceState({}, document.title, window.location.pathname);
                
                // é¡¯ç¤ºæ“ä½œå®Œæˆæç¤º
                showCompletionMessage();
            }
        }
        
        // é¡¯ç¤ºæ“ä½œå®Œæˆæç¤º
        function showCompletionMessage() {
            const message = document.createElement('div');
            message.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(45deg, #28a745, #20c997);
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
                z-index: 1000;
                animation: slideInRight 0.3s ease;
                font-weight: 500;
            `;
            message.innerHTML = 'âœ… æ“ä½œå·²å®Œæˆï¼';
            
            document.body.appendChild(message);
            
            // 3ç§’å¾Œè‡ªå‹•æ¶ˆå¤±
            setTimeout(() => {
                message.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => message.remove(), 300);
            }, 3000);
        }
    </script>
    
    <!-- å£“åŠ›æ¸¬è©¦ç¢ºèªæ¨¡æ…‹æ¡† -->
    <div id="stress-test-modal" class="custom-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-icon">ğŸ”¥</div>
                <h2 class="modal-title">å£“åŠ›æ¸¬è©¦ç¢ºèª</h2>
            </div>
            <div class="modal-body">
                <div class="modal-subtitle">æº–å‚™å°ä»¥ä¸‹ API é€²è¡Œå£“åŠ›æ¸¬è©¦ï¼š</div>
                <div style="text-align: center; font-size: 1.3em; font-weight: bold; margin: 15px 0; color: #ffd700;">
                    <span id="modal-api-name"></span>
                </div>
                
                <div class="stress-params">
                    <div class="param-row">
                        <span class="param-label">ä½µç™¼è«‹æ±‚æ•¸ï¼š</span>
                        <span class="param-value" id="param-concurrent"></span>
                    </div>
                    <div class="param-row">
                        <span class="param-label">æŒçºŒæ™‚é–“ï¼š</span>
                        <span class="param-value" id="param-duration"></span>
                    </div>
                    <div class="param-row">
                        <span class="param-label">è«‹æ±‚é–“éš”ï¼š</span>
                        <span class="param-value" id="param-interval"></span>
                    </div>
                </div>
                
                <div style="text-align: center; opacity: 0.8; font-size: 0.9em;">
                    âš ï¸ æ¸¬è©¦æœŸé–“å°‡å‘ç›®æ¨™ API ç™¼é€å¤§é‡è«‹æ±‚<br>
                    è«‹ç¢ºä¿æœ‰æ¬Šé™é€²è¡Œæ­¤æ“ä½œ
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-cancel" onclick="hideStressTestModal()">
                    å–æ¶ˆ
                </button>
                <button class="modal-btn modal-btn-confirm" onclick="confirmStressTest()">
                    ğŸš€ é–‹å§‹æ¸¬è©¦
                </button>
            </div>
        </div>
    </div>
</body>
</html>